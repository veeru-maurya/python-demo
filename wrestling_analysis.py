# Sample data
data = [
    {
        'date': '2024-08-09T11:27:40+02:00',
        'stage_code': 'WREMFS125KG-----------8FNL000100--',
        'event_code': 'WREMFS125KG',
        'event_name': "Men's Freestyle 125kg",
        'event_stage': "Men's Freestyle 125kg 1/8 Final",
        'stage': '1/8 Final',
        'gender': 'M',
        'discipline_name': 'Wrestling',
        'discipline_code': 'WRE',
        'venue': 'Champ-de-Mars Arena',
        'participant_code': 1543088,
        'participant_name': 'ZARE Amir Hossein',
        'participant_type': 'Person',
        'participant_country_code': 'IRI',
        'participant_country': 'IR Iran',
        'result': 5,
        'result_WLT': 'W',
        'bib': 1
    },
    {
        'date': '2024-08-09T11:27:40+02:00',
        'stage_code': 'WREMFS125KG-----------8FNL000100--',
        'event_code': 'WREMFS125KG',
        'event_name': "Men's Freestyle 125kg",
        'event_stage': "Men's Freestyle 125kg 1/8 Final",
        'stage': '1/8 Final',
        'gender': 'M',
        'discipline_name': 'Wrestling',
        'discipline_code': 'WRE',
        'venue': 'Champ-de-Mars Arena',
        'participant_code': 1955904,
        'participant_name': 'LAZAREV Aiaal',
        'participant_type': 'Person',
        'participant_country_code': 'KGZ',
        'participant_country': 'Kyrgyzstan',
        'result': 0,
        'result_WLT': 'L',
        'bib': 9
    },
    {
        'date': '2024-08-09T11:36:28+02:00',
        'stage_code': 'WREMFS125KG-----------8FNL000200--',
        'event_code': 'WREMFS125KG',
        'event_name': "Men's Freestyle 125kg",
        'event_stage': "Men's Freestyle 125kg 1/8 Final",
        'stage': '1/8 Final',
        'gender': 'M',
        'discipline_name': 'Wrestling',
        'discipline_code': 'WRE',
        'venue': 'Champ-de-Mars Arena',
        'participant_code': 1967710,
        'participant_name': 'DHESI Amarveer',
        'participant_type': 'Person',
        'participant_country_code': 'CAN',
        'participant_country': 'Canada',
        'result': 2,
        'result_WLT': 'W',
        'bib': 10
    },
    {
        'date': '2024-08-09T11:36:28+02:00',
        'stage_code': 'WREMFS125KG-----------8FNL000200--',
        'event_code': 'WREMFS125KG',
        'event_name': "Men's Freestyle 125kg",
        'event_stage': "Men's Freestyle 125kg 1/8 Final",
        'stage': '1/8 Final',
        'gender': 'M',
        'discipline_name': 'Wrestling',
        'discipline_code': 'WRE',
        'venue': 'Champ-de-Mars Arena',
        'participant_code': 1919998,
        'participant_name': 'DENG Zhiwei',
        'participant_type': 'Person',
        'participant_country_code': 'CHN',
        'participant_country': 'China',
        'result': 1,
        'result_WLT': 'L',
        'bib': 8
    },
    {
        'date': '2024-08-09T11:41:22+02:00',
        'stage_code': 'WREMFS125KG-----------8FNL000300--',
        'event_code': 'WREMFS125KG',
        'event_name': "Men's Freestyle 125kg",
        'event_stage': "Men's Freestyle 125kg 1/8 Final",
        'stage': '1/8 Final',
        'gender': 'M',
        'discipline_name': 'Wrestling',
        'discipline_code': 'WRE',
        'venue': 'Champ-de-Mars Arena',
        'participant_code': 1911553,
        'participant_name': 'LIGETI Daniel',
        'participant_type': 'Person',
        'participant_country_code': 'HUN',
        'participant_country': 'Hungary',
        'result': 11,
        'result_WLT': 'W',
        'bib': 5
    },
    {
        'date': '2024-08-09T11:41:22+02:00',
        'stage_code': 'WREMFS125KG-----------8FNL000300--',
        'event_code': 'WREMFS125KG',
        'event_name': "Men's Freestyle 125kg",
        'event_stage': "Men's Freestyle 125kg 1/8 Final",
        'stage': '1/8 Final',
        'gender': 'M',
        'discipline_name': 'Wrestling',
        'discipline_code': 'WRE',
        'venue': 'Champ-de-Mars Arena',
        'participant_code': 1568156,
        'participant_name': 'MUTUWA Ashton Adeyemi',
        'participant_type': 'Person',
        'participant_country_code': 'NGR',
        'participant_country': 'Nigeria',
        'result': 0,
        'result_WLT': 'L',
        'bib': 11
    },
    {
        'date': '2024-08-09T11:51:36+02:00',
        'stage_code': 'WREMFS125KG-----------8FNL000400--',
        'event_code': 'WREMFS125KG',
        'event_name': "Men's Freestyle 125kg",
        'event_stage': "Men's Freestyle 125kg 1/8 Final",
        'stage': '1/8 Final',
        'gender': 'M',
        'discipline_name': 'Wrestling',
        'discipline_code': 'WRE',
        'venue': 'Champ-de-Mars Arena',
        'participant_code': 1551794,
        'participant_name': 'SMITH Jonovan Darius',
        'participant_type': 'Person',
        'participant_country_code': 'PUR',
        'participant_country': 'Puerto Rico',
        'result': 0,
        'result_WLT': 'L',
        'bib': 12
    },
    {
        'date': '2024-08-09T11:51:36+02:00',
        'stage_code': 'WREMFS125KG-----------8FNL000400--',
        'event_code': 'WREMFS125KG',
        'event_name': "Men's Freestyle 125kg",
        'event_stage': "Men's Freestyle 125kg 1/8 Final",
        'stage': '1/8 Final',
        'gender': 'M',
        'discipline_name': 'Wrestling',
        'discipline_code': 'WRE',
        'venue': 'Champ-de-Mars Arena',
        'participant_code': 1570546,
        'participant_name': 'AKGUL Taha',
        'participant_type': 'Person',
        'participant_country_code': 'TUR',
        'participant_country': 'TÃ¼rkiye',
        'result': 10,
        'result_WLT': 'W',
        'bib': 4
    },
    {
        'date': '2024-08-09T12:05:06+02:00',
        'stage_code': 'WREMFS125KG-----------8FNL000500--',
        'event_code': 'WREMFS125KG',
        'event_name': "Men's Freestyle 125kg",
        'event_stage': "Men's Freestyle 125kg 1/8 Final",
        'stage': '1/8 Final',
        'gender': 'M',
        'discipline_name': 'Wrestling',
        'discipline_code': 'WRE',
        'venue': 'Champ-de-Mars Arena',
        'participant_code': 1955461,
        'participant_name': 'PARRIS Mason Mark',
        'participant_type': 'Person',
        'participant_country_code': 'USA',
        'participant_country': 'United States',
        'result': 5,
        'result_WLT': 'L',
        'bib': 3
    }
]

def count_results(data):
    wins = 0
    losses = 0
    for match in data:
        if match['result_WLT'] == 'W':
            wins += 1
        elif match['result_WLT'] == 'L':
            losses += 1
    return wins, losses

def get_participant_stats(data):
    stats = {}
    for match in data:
        participant = match['participant_name']
        if participant not in stats:
            stats[participant] = {'wins': 0, 'losses': 0, 'country': match['participant_country'], 'matches': 0}
        if match['result_WLT'] == 'W':
            stats[participant]['wins'] += 1
        elif match['result_WLT'] == 'L':
            stats[participant]['losses'] += 1
        stats[participant]['matches'] += 1
    return stats

def get_event_stats(data):
    total_matches = len(data)
    wins, losses = count_results(data)
    return {
        'total_matches': total_matches,
        'total_wins': wins,
        'total_losses': losses,
        'win_percentage': (wins / total_matches) * 100 if total_matches > 0 else 0,
        'loss_percentage': (losses / total_matches) * 100 if total_matches > 0 else 0
    }

def display_event_stats(event_stats):
    print(f"\nTotal Matches: {event_stats['total_matches']}")
    print(f"Total Wins: {event_stats['total_wins']}")
    print(f"Total Losses: {event_stats['total_losses']}")
    print(f"Win Percentage: {event_stats['win_percentage']:.2f}%")
    print(f"Loss Percentage: {event_stats['loss_percentage']:.2f}%")

def display_participant_statistics(participant_stats):
    print("\nParticipant Statistics:")
    for participant, stats in participant_stats.items():
        print(f"{participant} ({stats['country']}): Wins - {stats['wins']}, Losses - {stats['losses']}, Matches - {stats['matches']}")

def get_participant_info(participant_stats):
    print("\nEnter the name of the participant to view detailed stats:")
    name = input().strip()
    if name in participant_stats:
        stats = participant_stats[name]
        print(f"\n{name} ({stats['country']})")
        print(f"Total Matches: {stats['matches']}")
        print(f"Wins: {stats['wins']}")
        print(f"Losses: {stats['losses']}")
    else:
        print("Participant not found.")

def display_top_participant(participant_stats):
    if not participant_stats:
        print("No participant data available.")
        return
    
    top_participant = max(participant_stats, key=lambda p: participant_stats[p]['wins'])
    stats = participant_stats[top_participant]
    print(f"\nTop Participant by Wins:")
    print(f"{top_participant} ({stats['country']})")
    print(f"Wins: {stats['wins']}")
    print(f"Losses: {stats['losses']}")
    print(f"Total Matches: {stats['matches']}")

def display_participants_with_no_wins(participant_stats):
    print("\nParticipants with No Wins:")
    for participant, stats in participant_stats.items():
        if stats['wins'] == 0:
            print(f"{participant} ({stats['country']})")

def display_participants_with_no_losses(participant_stats):
    print("\nParticipants with No Losses:")
    for participant, stats in participant_stats.items():
        if stats['losses'] == 0:
            print(f"{participant} ({stats['country']})")

def display_streak(data):
    print("\nEnter the name of the participant to view streak:")
    name = input().strip()
    matches = [match for match in data if match['participant_name'].lower() == name.lower()]
    if matches:
        streak = 0
        current_result = matches[0]['result_WLT']
        for match in matches:
            if match['result_WLT'] == current_result:
                streak += 1
            else:
                break
        print(f"\n{name} has a {current_result} streak of {streak} matches.")
    else:
        print("No matches found for this participant.")

def display_matches_by_country_totals(data):
    country_stats = {}
    for match in data:
        country = match['participant_country']
        if country not in country_stats:
            country_stats[country] = {'matches': 0, 'wins': 0, 'losses': 0}
        country_stats[country]['matches'] += 1
        if match['result_WLT'] == 'W':
            country_stats[country]['wins'] += 1
        elif match['result_WLT'] == 'L':
            country_stats[country]['losses'] += 1

    print("\nMatches by Country:")
    for country, stats in country_stats.items():
        print(f"{country}: Matches - {stats['matches']}, Wins - {stats['wins']}, Losses - {stats['losses']}")

def display_participants_by_win_percentage(participant_stats):
    ranked_participants = sorted(participant_stats.items(), key=lambda p: (p[1]['wins'] / p[1]['matches']) if p[1]['matches'] > 0 else 0, reverse=True)
    
    print("\nParticipants Ranked by Win Percentage:")
    for participant, stats in ranked_participants:
        win_percentage = (stats['wins'] / stats['matches']) * 100 if stats['matches'] > 0 else 0
        print(f"{participant} ({stats['country']}): Win Percentage - {win_percentage:.2f}%")

def main():
    event_stats = get_event_stats(data)
    participant_stats = get_participant_stats(data)
    
    print("Welcome to the Wrestling Match Analysis Tool!")
    while True:
        print("\nSelect an option:")
        print("1. View overall results")
        print("2. View participant statistics")
        print("3. View detailed stats for a specific participant")
        print("4. View top participant by wins")
        print("5. View participants with no wins")
        print("6. View participants with no losses")
        print("7. View current streak for a participant")
        print("8. View total matches by country")
        print("9. View participants ranked by win percentage")
        print("10. Exit")

        choice = input().strip()

        if choice == '1':
            display_event_stats(event_stats)
        elif choice == '2':
            display_participant_statistics(participant_stats)
        elif choice == '3':
            get_participant_info(participant_stats)
        elif choice == '4':
            display_top_participant(participant_stats)
        elif choice == '5':
            display_participants_with_no_wins(participant_stats)
        elif choice == '6':
            display_participants_with_no_losses(participant_stats)
        elif choice == '7':
            display_streak(data)
        elif choice == '8':
            display_matches_by_country_totals(data)
        elif choice == '9':
            display_participants_by_win_percentage(participant_stats)
        elif choice == '10':
            print("Exiting the Wrestling Match Analysis Tool. Goodbye!")
            break
        else:
            print("Invalid option. Please select a valid choice.")

if __name__ == "__main__":
    main()
